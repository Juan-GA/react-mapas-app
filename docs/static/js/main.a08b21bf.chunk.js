(this["webpackJsonpmapas-app"]=this["webpackJsonpmapas-app"]||[]).push([[0],{48:function(e,t,n){},81:function(e,t,n){"use strict";n.r(t);var c=n(0),o=n(42),a=n.n(o),r=(n(48),n(15)),u=n(43),i=n.n(u),s=n(1),f=Object(c.createContext)(),l=function(e){var t=e.children,n=function(e){var t=Object(c.useMemo)((function(){return i.a.connect(e,{transports:["websocket"]})}),[e]),n=Object(c.useState)(!1),o=Object(r.a)(n,2),a=o[0],u=o[1];return Object(c.useEffect)((function(){u(t.connected)}),[t]),Object(c.useEffect)((function(){t.on("connect",(function(){return u(!0)}))}),[t]),Object(c.useEffect)((function(){t.on("disconnect",(function(){return u(!1)}))}),[t]),{socket:t,online:a}}("https://react-socket-mapas.herokuapp.com/"),o=n.socket,a=n.online;return Object(s.jsx)(f.Provider,{value:{socket:o,online:a},children:t})},b=n(16),d=n.n(b),j=n(85),O=n(84);d.a.accessToken="pk.eyJ1IjoianVhbi1nYSIsImEiOiJja3N4bDMwc28wZ216Mm5tc2FpZTNocjF3In0.hcGJX1BZIbbA6RtQ4WUypA";var m={lng:-96.9282,lat:19.5289,zoom:13.57},v=function(){var e=function(e){var t=Object(c.useRef)(),n=Object(c.useCallback)((function(e){t.current=e}),[]),o=Object(c.useRef)({}),a=Object(c.useRef)(new O.a),u=Object(c.useRef)(new O.a),i=Object(c.useRef)(),s=Object(c.useState)(e),f=Object(r.a)(s,2),l=f[0],b=f[1],m=Object(c.useCallback)((function(e,t){var n=e.lngLat||e,c=n.lng,r=n.lat,s=new d.a.Marker;s.id=null!==t&&void 0!==t?t:Object(j.a)(),s.setLngLat([c,r]).addTo(i.current).setDraggable(!0),o.current[s.id]=s,t||u.current.next({id:s.id,lng:c,lat:r}),s.on("drag",(function(e){var t=e.target,n=t.id,c=t.getLngLat(),o=c.lng,r=c.lat;a.current.next({id:n,lng:o,lat:r})}))}),[]),v=Object(c.useCallback)((function(e){var t=e.id,n=e.lng,c=e.lat;o.current[t].setLngLat([n,c])}),[]);return Object(c.useEffect)((function(){var n=new d.a.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v11",center:[e.lng,e.lat],zoom:e.zoom});i.current=n}),[e]),Object(c.useEffect)((function(){var e;null===(e=i.current)||void 0===e||e.on("move",(function(){var e=i.current.getCenter(),t=e.lng,n=e.lat;b({lng:t.toFixed(4),lat:n.toFixed(4),zoom:i.current.getZoom().toFixed(2)})}))}),[]),Object(c.useEffect)((function(){null===i||void 0===i||i.current.on("click",m)}),[m]),{actualizarPosicion:v,agregarMarcador:m,coords:l,marcadores:o,nuevoMarcador$:u.current,movimientoMarcador$:a.current,setRef:n}}(m),t=e.setRef,n=e.coords,o=e.nuevoMarcador$,a=e.movimientoMarcador$,u=e.agregarMarcador,i=e.actualizarPosicion,l=Object(c.useContext)(f).socket;return Object(c.useEffect)((function(){l.on("marcadores-activos",(function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var c=n[t];u(e[c],c)}}))}),[l,u]),Object(c.useEffect)((function(){o.subscribe((function(e){l.emit("marcador-nuevo",e)}))}),[o,l]),Object(c.useEffect)((function(){a.subscribe((function(e){l.emit("marcador-actualizado",e)}))}),[l,a]),Object(c.useEffect)((function(){l.on("marcador-actualizado",(function(e){i(e)}))}),[l,i]),Object(c.useEffect)((function(){l.on("marcador-nuevo",(function(e){u(e,e.id)}))}),[l,u]),Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)("div",{className:"info",children:["lng: ",n.lng," | lat: ",n.lat," | zoom: ",n.zoom]}),Object(s.jsx)("div",{ref:t,className:"mapContainer"})]})},g=function(){return Object(s.jsx)(l,{children:Object(s.jsx)(v,{})})};a.a.render(Object(s.jsx)(g,{}),document.getElementById("root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.a08b21bf.chunk.js.map